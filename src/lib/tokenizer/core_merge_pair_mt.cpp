// core function for merge pair using non-singleton memory pool